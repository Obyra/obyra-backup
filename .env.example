# ============================================
# OBYRA - Variables de Entorno
# ============================================
# Copiar este archivo a .env y configurar con tus valores
# cp .env.example .env

# ============================================
# Flask Configuration
# ============================================
FLASK_APP=app.py
# PRODUCCIÓN: Cambiar a 'production'
FLASK_ENV=development
# PRODUCCIÓN: Cambiar a 0 (NUNCA activar debug en producción)
FLASK_DEBUG=1

# IMPORTANTE: Generar con: python -c "import secrets; print(secrets.token_urlsafe(32))"
# NUNCA usar el valor por defecto en producción
SECRET_KEY=dev-secret-key-change-in-production

# ============================================
# Database Configuration
# ============================================
# PostgreSQL connection string
# Formato: postgresql+psycopg://usuario:password@host:puerto/database
DATABASE_URL=postgresql+psycopg://obyra:obyra_dev_password@localhost:5432/obyra_dev

# Alembic migrations (puede ser igual que DATABASE_URL)
ALEMBIC_DATABASE_URL=postgresql+psycopg://obyra:obyra_dev_password@localhost:5432/obyra_dev

# ============================================
# Redis Configuration
# ============================================
# Cache y sesiones
REDIS_URL=redis://localhost:6379/0

# Rate limiting (usar database diferente)
RATE_LIMITER_STORAGE=redis://localhost:6379/1

# ============================================
# Email Configuration (SMTP)
# ============================================
# Requerido en producción para envío de emails
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=tu_email@gmail.com
SMTP_PASSWORD=tu_app_password
FROM_EMAIL=noreply@obyra.com

# ============================================
# Application Configuration
# ============================================
# URL base de la aplicación (importante para emails y webhooks)
BASE_URL=http://localhost:5000

# ============================================
# Payments - Mercado Pago (Opcional)
# ============================================
MP_ACCESS_TOKEN=
MP_WEBHOOK_SECRET=
MP_WEBHOOK_PUBLIC_URL=
PLATFORM_COMMISSION_RATE=0.10

# ============================================
# AI Services - OpenAI (Opcional)
# ============================================
# Para calculadora IA de presupuestos
OPENAI_API_KEY=

# ============================================
# OAuth - Google (Opcional)
# ============================================
# Obtener desde: https://console.cloud.google.com/
GOOGLE_OAUTH_CLIENT_ID=
GOOGLE_OAUTH_CLIENT_SECRET=
ENABLE_GOOGLE_OAUTH_HELP=0

# ============================================
# Maps/Geocoding (Opcional)
# ============================================
# Opciones: nominatim (gratis), google, mapbox
MAPS_PROVIDER=nominatim
MAPS_API_KEY=
MAPS_USER_AGENT=OBYRA/1.0

# ============================================
# Feature Flags
# ============================================
# Habilitar módulo de reportes
ENABLE_REPORTS=1

# Habilitar wizard de presupuestos
WIZARD_BUDGET_BREAKDOWN_ENABLED=1
WIZARD_BUDGET_SHADOW_MODE=0

# Mostrar botón de calculadora IA
SHOW_IA_CALCULATOR_BUTTON=0

# ============================================
# Migrations
# ============================================
# Ejecutar migraciones al iniciar (Docker)
RUN_MIGRATIONS=false

# ============================================
# Security Configuration
# ============================================
# IMPORTANTE: Super admin privileges son manejados vía la columna
# is_super_admin en la base de datos, NO con emails hardcodeados.
# Para otorgar privilegios de super admin:
# UPDATE usuarios SET is_super_admin = true WHERE email = 'admin@tu-empresa.com';

# Contraseña por defecto para usuario admin (cambiar en producción)
ADMIN_DEFAULT_PASSWORD=admin123

# Configuración de seguridad de sesiones
# Se activa automáticamente con FLASK_ENV=production
SESSION_COOKIE_SECURE=false
SESSION_LIFETIME_HOURS=24     # Duración de sesión en horas

# CORS - Orígenes permitidos (separados por coma)
# PRODUCCIÓN: Especificar dominios exactos
# Ejemplo: https://app.obyra.com,https://www.obyra.com
CORS_ALLOWED_ORIGINS=

# Configuración de uploads
MAX_UPLOAD_SIZE_MB=16  # Tamaño máximo de archivo en MB

# ============================================
# Billing / Facturación
# ============================================
# IMPORTANTE: Completar cuando tengas la empresa constituida legalmente

# Datos de la empresa
BILLING_COMPANY_NAME=OBYRA S.A.S.
BILLING_COMPANY_TAX_ID=              # CUIT formato: XX-XXXXXXXX-X
BILLING_COMPANY_TAX_CONDITION=Responsable Inscripto
BILLING_COMPANY_ADDRESS=
BILLING_COMPANY_CITY=
BILLING_COMPANY_PROVINCE=
BILLING_COMPANY_POSTAL_CODE=
BILLING_COMPANY_EMAIL=facturacion@obyra.com
BILLING_COMPANY_PHONE=
BILLING_COMPANY_START_DATE=          # Formato: DD/MM/YYYY

# AFIP - Facturación Electrónica (completar cuando esté habilitado)
BILLING_AFIP_ENABLED=false
BILLING_AFIP_CUIT=
BILLING_AFIP_CERT_PATH=              # Ruta al certificado .crt
BILLING_AFIP_KEY_PATH=               # Ruta a la clave privada .key
BILLING_AFIP_PRODUCTION=false        # false para homologación, true para producción
BILLING_AFIP_POS=00001               # Punto de venta

# Datos bancarios para transferencias
BILLING_BANK_CBU=
BILLING_BANK_ALIAS=
BILLING_BANK_NAME=

# Configuración de facturación
BILLING_IVA_PERCENTAGE=21.0
BILLING_DAY_OF_MONTH=1               # Día del mes para facturación automática
BILLING_COMPANY_LOGO_PATH=images/logo-factura.png
BILLING_INVOICE_FOOTER_TEXT=Gracias por confiar en OBYRA

# ============================================
# Docker-Specific Configuration
# ============================================
# Estas variables solo se usan cuando corres con Docker

# PostgreSQL (solo para Docker)
POSTGRES_DB=obyra_dev
POSTGRES_USER=obyra
# PRODUCCIÓN: Generar con: python -c "import secrets; print(secrets.token_urlsafe(24))"
POSTGRES_PASSWORD=CAMBIAR_EN_PRODUCCION
POSTGRES_MIGRATOR_USER=obyra_migrator
# PRODUCCIÓN: Generar con: python -c "import secrets; print(secrets.token_urlsafe(24))"
POSTGRES_MIGRATOR_PASSWORD=CAMBIAR_EN_PRODUCCION

# Celery (solo para Docker)
CELERY_BROKER_URL=redis://redis:6379/1
CELERY_RESULT_BACKEND=redis://redis:6379/2

# ============================================
# Notas Importantes
# ============================================
# 1. NO commitear este archivo con valores reales a git
# 2. Generar SECRET_KEY seguro para producción
# 3. Usar contraseñas fuertes para base de datos
# 4. Configurar SMTP correctamente para producción
# 5. Rate limiting requiere Redis funcionando
