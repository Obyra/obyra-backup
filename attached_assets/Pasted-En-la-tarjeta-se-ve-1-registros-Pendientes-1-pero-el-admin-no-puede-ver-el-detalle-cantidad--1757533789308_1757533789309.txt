En la tarjeta se ve “1 registros / Pendientes (1)”, pero el admin no puede ver el detalle (cantidad, notas, fotos) ni aprobar/rechazar. Necesitamos la vista/API de revisión.

Qué hacer
1) Endpoints (JSON, sin redirects)

Lista de avances por tarea (admin):

GET /tareas/<tarea_id>/avances?estado=all|pendiente|aprobado|rechazado

Respuesta JSON: [{id, created_at, user:{id,nombre,ini}, cantidad, unidad, notas, estado, fotos:[url,...]}]

Validar que la tarea pertenezca a la misma organización del admin.

Aprobar/Rechazar avance:

POST /avances/<id>/aprobar

POST /avances/<id>/rechazar (body: motivo)

Responder siempre JSON: {"ok": true} o {"ok": false, "error": "…"}

Recalcular progreso al aprobar: tarea.avance_aprobado = SUM(cantidad WHERE estado='aprobado')

2) Modelo (si falta)
class AvanceTarea(db.Model):
    id = db.Column(db.Integer, primary_key=True)
    tarea_id = db.Column(db.Integer, db.ForeignKey('tarea_etapa.id'), index=True)
    user_id  = db.Column(db.Integer, db.ForeignKey('user.id'))
    cantidad = db.Column(db.Float)          # progreso físico
    unidad   = db.Column(db.String(10))     # copiar de tarea.unidad
    notas    = db.Column(db.Text)
    estado   = db.Column(db.String(12), default='pendiente')  # pendiente/aprobado/rechazado
    created_at = db.Column(db.DateTime, default=datetime.utcnow)

class AvanceFoto(db.Model):
    id = db.Column(db.Integer, primary_key=True)
    avance_id = db.Column(db.Integer, db.ForeignKey('avance_tarea.id'), index=True)
    path = db.Column(db.String(255))  # ruta relativa

3) Archivos (fotos)

Guardar en uploads/avances/<obra_id>/<tarea_id>/.

Agregar ruta para servirlos:

GET /uploads/avances/<path:subpath> → send_from_directory

Generar URLs con url_for(...) en el JSON.

4) UI rápidísima (modal de revisión)

En la tarjeta, que “1 registros” y/o “Pendientes (1)” sea clickeable → abre modal “Revisión de Avances”.

Modal lista cada avance:

Fecha y usuario, cantidad + unidad, notas, thumbnails de fotos (click abre full).

Botones: Aprobar / Rechazar (con motivo).

Al aprobar/rechazar:

Llamar a los endpoints.

Cerrar/actualizar modal, actualizar contador de “Pendientes (N)” y barra de progreso de la tarea.

5) Permisos

Solo admin de la obra puede ver/aprobar/rechazar.

Operario ve sólo lo propio y no puede aprobar.

6) Criterios de aceptación

Click en “Pendientes (1)” abre la lista con detalle y fotos.

Aprobar cambia estado a aprobado, baja el contador de pendientes y actualiza el % de avance.

Rechazar pide motivo y lo guarda.

Todas las respuestas de API son JSON (nunca HTML/redirect).

Fotos se ven (URLs válidas) y abren en nueva pestaña.