1) Objetivo

Permitir que el usuario:

Seleccione etapas del proyecto.

Elija tareas dentro de esas etapas.

Cargue datos operativos (inicio, fin, horas, unidad/medida, cantidad, responsable/usuario, notas, fotos).

Confirme y que todo quede creado y visible en la obra, para que el administrador pueda ver el plan, el avance y las fotos.

2) Flujo esperado (paso a paso)
Paso 1 – Selección de etapas

UI: grilla con tarjetas de etapas (Ej.: Excavación, Mampostería, Techos, etc.).

Acción: el usuario tilda una o más etapas.

Botones: Siguiente (habilitado solo si hay al menos una etapa marcada) y Volver (cierra wizard).

Estado: las etapas elegidas quedan guardadas en memoria del wizard (persisten si vuelvo atrás o recargo).

Paso 2 – Selección de tareas (según etapas del Paso 1)

UI: listado de plantillas de tareas agrupadas por etapa; panel lateral “Tareas seleccionadas” que se actualiza en tiempo real.

Acción: el usuario tilda/destilda tareas.

Regla: no se avanza sin al menos una tarea.

Estado: las tareas seleccionadas se conservan al volver a Paso 1 o avanzar a Paso 3.

Paso 3 – Datos de planificación / ejecución

UI: formulario con los campos para todas las tareas seleccionadas (puede ser por bloque o por tarea):

Fecha inicio y Fecha fin

Horas estimadas

Unidad/Medida (m², m³, ml, unidades, etc.) + Cantidad

Responsable/Usuario asignado

Notas (opcional)

Adjuntos/Fotos (opcional, 1..n)

Validación: fechas válidas (fin ≥ inicio), horas y cantidad numéricas, usuario obligatorio.

Botones: Siguiente/Confirmar y Atrás.

Paso 4 – Resumen y confirmación

UI: tabla/resumen con: Etapa → Tareas → [inicio, fin, horas, unidad, cantidad, responsable, notas] + miniaturas de fotos.

Acción: Confirmar crea los registros.

Resultado: redirige a la vista de la obra, donde el administrador ve:

Etapas con su estado y % de avance.

Listado de tareas con la info cargada.

Fotos adjuntas por tarea.

Posibilidad de actualizar avance/fotos más adelante.

3) Reglas de negocio clave

Paso 1 requiere ≥1 etapa.

Paso 2 requiere ≥1 tarea.

Paso 3 requiere: fechas válidas, responsable y al menos unidad+cantidad o horas.

La navegación Atrás/Siguiente no debe perder lo seleccionado.

Si el wizard se cierra y se reabre, conservar estado mientras dure la sesión (si es posible).

4) Comportamiento de UI (importante)

La lista de tareas solo se muestra cuando Paso 2 está activo (evitar renders “prematuros”).

El panel “Tareas seleccionadas” debe reflejar en vivo lo que se tilda/destilda.

Evitar problemas de accesibilidad/foco: no usar aria-hidden sobre pestañas que contienen el foco; si se usa, mover el foco al paso activo o usar inert.

5) Datos a persistir por tarea

etapa_id

tarea_id

fecha_inicio

fecha_fin

horas_estimadas

unidad / medida

cantidad

responsable_usuario_id

notas

fotos[] (urls o blobs según implementen)

6) Visibilidad para Administrador (vista de obra)

Sección Etapas con estado y avance.

Dentro de cada etapa: tareas con todos los campos anteriores.

Galería o lista de fotos por tarea.

Filtros básicos: por etapa, por responsable, por estado.

(Deseable) Indicador de tareas atrasadas vs. fecha fin.

7) Criterios de aceptación (QA)

Selección

Dado que estoy en Paso 1, cuando marco 2 etapas y doy “Siguiente”, en Paso 2 solo aparecen tareas de esas etapas.

Si destildo todas las tareas, el botón “Siguiente” queda deshabilitado.

Panel en vivo

Al marcar 3 tareas, el panel “Tareas seleccionadas” muestra exactamente esas 3 por nombre.

Al destildar una, el panel se actualiza al instante.

Validaciones

En Paso 3, si fin < inicio, veo mensaje claro y no avanza.

Si falta responsable o cantidad/horas, veo error y no avanza.

Confirmación

Tras confirmar, la vista de la obra muestra las tareas con sus datos y las fotos cargadas.

Si vuelvo al wizard, el estado previo se conserva durante la sesión.

Accesibilidad/fluidez

No hay “saltos” de pasos ni regresos espontáneos al Paso 1.

No aparecen warnings de foco oculto por aria-hidden.

8) Alcance de este MVP

Incluye: flujo 4 pasos, persistencia de datos por tarea, vista en obra con info y fotos.
No incluye (por ahora): notificaciones, permisos avanzados, edición masiva, dependencias de tareas, calendarios Gantt, etc.

9) Entregables

Wizard funcional con los 4 pasos descritos.

Vista de obra mostrando lo creado (con fotos).

Mensajería de error/validación clara.

Registro de eventos en consola para QA (tildado/destildado, validaciones, creación).

10) Supuestos

Ya existen catálogos de etapas y tareas.

Existe almacenamiento para fotos (local o cloud).

Se puede mantener estado del wizard en memoria de la página mientras dure la sesión.