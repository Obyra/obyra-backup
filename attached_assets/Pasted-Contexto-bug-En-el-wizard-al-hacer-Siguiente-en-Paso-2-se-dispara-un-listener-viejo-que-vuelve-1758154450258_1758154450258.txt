Contexto / bug:

En el wizard, al hacer Siguiente en Paso 2, se dispara un listener viejo que vuelve a ejecutar “Aplicando catálogo…” y regresa a Paso 2.

Además aparece Uncaught ReferenceError: connectPaso2Nav is not defined (p. ej. wizard.js:578).

Hay funciones y listeners duplicados en static/js/wizard.js.

Lo que necesito exactamente:

Eliminar código legacy y duplicado de navegación en static/js/wizard.js:

Borrar todas las referencias y definiciones viejas de:

connectPaso2Nav, connectPaso2Next, connectPaso2*, “LÓGICA DE NAVEGACIÓN DEL WIZARD” repetidas, y cualquier otro handler duplicado del botón Siguiente.

Debe quedar un solo bloque canónico.

Bloque canónico (dejar implementado y exportado en window):

window.getSelPaso2(modal)
Lee #wizardStep2 input[type="checkbox"]:checked y devuelve [{id, nombre, etapa_slug}] (label por defecto si no hay dataset).

window.ensureOpciones(obra_id)
GET /obras/api/wizard-tareas/opciones?obra_id=<id>; fallback unidades ['m2','m','m3','u','kg','h'] y usuarios [].

window.renderPaso3(tareasSel)
Pinta filas en #wizardStep3 #tablaDatosWizard tbody con inputs/ selects: Inicio, Fin, Horas Est (default 8), Cantidad (1), .unidad-select, .asignado-select. Llama a window.enableNextStep3() y crea (si no existe) botón Atrás #wizardBtnAnteriorPaso3 que hace gotoPaso(2) y preserva selección.

window.enableNextStep3()
Habilita/deshabilita #wizardBtnSiguiente según tbody tr > 0.

window.gotoPaso(n)
Soporta #wizardStepX o #wizardPasoX; alterna .d-none y actualiza progreso con updateWizardProgress(n) si existe.

Interceptor único del botón Siguiente en Paso 2 (compat con legacy):

Antes de enganchar, clonar y reemplazar #wizardBtnSiguiente para eliminar cualquier listener viejo.

Nuevo handler:

Si NO está visible Paso 2 → no interceptar (dejar fluir).

Si está visible Paso 2 → preventDefault(), stopPropagation(), stopImmediatePropagation(),
const sel = getSelPaso2();
Si sel.length === 0 → no avanzar.
Guardar en window.WZ_STATE.tareasSel = sel;
gotoPaso(3); renderPaso3(sel); updateWizardProgress?.(3);

Para compatibilidad, definir window.connectPaso2Nav = <el mismo handler> para que cualquier llamada vieja apunte al nuevo.

Asegurar que solo se agrega 1 listener:

Usar el reemplazo del botón (cloneNode + replaceWith) antes de addEventListener.

No debe quedar ningún addEventListener duplicado para Siguiente.

Criterios de aceptación (QA rápido):

En consola NO aparece más connectPaso2Nav is not defined.

Click en Siguiente con Paso 2 visible ya no dispara “Aplicando catálogo…” ni regresa a Paso 2.

Paso 3 muestra N filas = cantidad de checkboxes seleccionados, con selects de Unidad y Asignado poblados (o fallback).

Botón Atrás vuelve a Paso 2 manteniendo la selección.

Progreso visual se mueve a Paso 3.